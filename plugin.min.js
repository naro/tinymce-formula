!function(t){function e(t,e){e.path;t.windowManager.open({title:"Formula",width:900,height:610,html:a(t,e),buttons:[{text:"Cancel",onclick:function(){this.parent().parent().close()}},{text:"Insert Formula",subtype:"primary",onclick:function(e){var a=this;window.frames.tinymceFormula&&window.frames.tinymceFormula.getData?window.frames.tinymceFormula.getData(function(e,n,i){e&&t.insertContent('<img class="fm-editor-equation" src="'+e+'" data-mlang="'+n+'" data-equation="'+encodeURIComponent(i)+'"/>'),a.parent().parent().close()}):a.parent().parent().close()}}]})}function a(t,e){var a=e.path,n=t.selection.getNode(),i=t.getParam("language")||"en",o="&mlang="+e.mlang,r="";return"img"==n.nodeName.toLowerCase()&&n.className.indexOf("fm-editor-equation")>-1&&(n.getAttribute("data-mlang")&&(o="&mlang="+n.getAttribute("data-mlang")),n.getAttribute("data-equation")&&(r="&equation="+n.getAttribute("data-equation"))),'<iframe name="tinymceFormula" id="tinymceFormula" src="'+a+"/index.html?lang="+i+o+r+'" scrolling="no" frameborder="0"></iframe>'}t.create("tinymce.plugins.Formula",{init:function(t,a){var n=t.getParam("formula")||{},i={};i.path=n.path||a,i.mlang=n.mlang||"latex",t.addButton("formula",{image:i.path+"/img/formula.png",tooltip:"Insert Formula",onclick:e.bind(this,t,i),onPostRender:function(){var e=this;t.on("NodeChange",function(t){e.active(t.element.className.indexOf("fm-editor-equation")>-1&&"img"==t.element.nodeName.toLowerCase())})}})}}),t.PluginManager.requireLangPack("formula","en,es,fr_FR"),t.PluginManager.add("formula",t.plugins.Formula)}(window.tinymce);